# **MODELE PRINCIPAL-AGENT**


Le mod√®le Principal-Agent √©tudie les relations de d√©l√©gation o√π un principal  confie une t√¢che √† un agent, en pr√©sence d'asym√©trie d'information. Le principal  ne peut pas observer directement l'effort fourni par l'agent, ce qui cr√©e un  probl√®me d'al√©a moral (moral hazard). Cette situation est omnipr√©sente dans les relations √©conomiques : employeur-salari√©, actionnaire-manager, assur√©-assureur, etc.

L'objectif de ce notebook est de resoudre num√©riquement le mod√®le principal-agent.

##  Import et configuration


```python
import numpy as np
from scipy.optimize import minimize
import matplotlib.pyplot as plt
from typing import Dict, Tuple, List

# Configuration pour les graphiques
plt.style.use('seaborn-v0_8-darkgrid')
plt.rcParams['figure.figsize'] = (12, 6)
plt.rcParams['font.size'] = 10
```

### Classe principale du mod√®le

# üìò Classe `PrincipalAgentModel`

### R√¥le g√©n√©ral de la classe

La classe `PrincipalAgentModel` impl√©mente un mod√®le standard de **principal‚Äìagent avec al√©a moral**. Elle regroupe l‚Äôensemble des param√®tres √©conomiques du mod√®le (profits, probabilit√©s, d√©sutilit√©s, utilit√© de r√©serve et aversion au risque) ainsi que les fonctions fondamentales permettant de calculer l‚Äôutilit√© de l‚Äôagent et le profit du principal. Cette classe constitue le **c≈ìur du mod√®le**, sur lequel reposent toutes les r√©solutions (first-best, second-best et v√©rification de l‚Äô√©quilibre).

**Arguments**

* `q_bar` : profit du principal en cas de succ√®s.
* `q` : profit du principal en cas d‚Äô√©chec.
* `pi_H` : probabilit√© de succ√®s lorsque l‚Äôagent fournit l‚Äôeffort √©lev√©.
* `pi_B` : probabilit√© de succ√®s lorsque l‚Äôagent fournit l‚Äôeffort faible.
* `d_H` : d√©sutilit√© associ√©e √† l‚Äôeffort √©lev√©.
* `d_B` : d√©sutilit√© associ√©e √† l‚Äôeffort faible.
* `u_r` : utilit√© de r√©serve de l‚Äôagent.
* `gamma` : coefficient d‚Äôaversion au risque de l‚Äôagent.

**Sortie**

* Aucune valeur retourn√©e.
* Les param√®tres sont stock√©s comme attributs de l‚Äôobjet.

**Interpr√©tation √©conomique**
Ces param√®tres d√©finissent l‚Äôenvironnement informationnel et technologique du contrat. Les assertions garantissent que le mod√®le respecte les hypoth√®ses standards de la th√©orie du principal‚Äìagent.


### Fonction `utility_agent`

**Description**
Cette fonction d√©finit la **fonction d‚Äôutilit√© instantan√©e** de l‚Äôagent en fonction du salaire per√ßu.

**Arguments**

* `w` : salaire re√ßu par l‚Äôagent.

**Sortie**

* Valeur de l‚Äôutilit√© instantan√©e ( u(w) ).

**Forme fonctionnelle**
$$
u(w) = w^\gamma
$$

**Interpr√©tation √©conomique**
La concavit√© de la fonction (Œ≥ < 1) traduit l‚Äôaversion au risque de l‚Äôagent. Cette fonction est utilis√©e pour calculer l‚Äôutilit√© esp√©r√©e associ√©e √† un contrat donn√©.


### Fonction `expected_utility_agent`

**Description**
Cette fonction calcule l‚Äô**utilit√© esp√©r√©e nette de l‚Äôagent**, en tenant compte de l‚Äôincertitude sur le r√©sultat et de la d√©sutilit√© de l‚Äôeffort.

**Arguments**

* `w_bar` : salaire en cas de succ√®s.
* `w` : salaire en cas d‚Äô√©chec.
* `effort` : niveau d‚Äôeffort choisi par l‚Äôagent (`'H'` ou `'B'`).

**Sortie**

* Utilit√© esp√©r√©e nette de l‚Äôagent.

**Formule impl√©ment√©e**
$$
U_A = \pi_e u(wÃÑ) + (1-\pi_e)u(w) - d(e)
$$

**Interpr√©tation √©conomique**
Cette fonction est centrale pour v√©rifier :

* la **contrainte de participation** (acceptation du contrat),
* la **contrainte d‚Äôincitation** (choix optimal de l‚Äôeffort).

### Fonction `expected_profit_principal`

**Description**
Cette fonction calcule le **profit esp√©r√© du principal** en fonction du contrat propos√© et de l‚Äôeffort fourni.

**Arguments**

* `w_bar` : salaire vers√© en cas de succ√®s.
* `w` : salaire vers√© en cas d‚Äô√©chec.
* `effort` : effort fourni par l‚Äôagent (`'H'` ou `'B'`).

**Sortie**

* Profit esp√©r√© du principal.

**Formule impl√©ment√©e**
[\Pi = \pi_e (qÃÑ - wÃÑ) + (1-\pi_e)(q - w)]

**Interpr√©tation √©conomique**
Cette fonction permet d‚Äô√©valuer la rentabilit√© du contrat pour le principal sous chaque r√©gime informationnel.


```python
class PrincipalAgentModel:
    """
    Mod√®le Principal-Agent avec al√©a moral
    
    Notations conformes au document:
    - q_bar: profit en cas de succ√®s
    - q: profit en cas d'√©chec
    - w_bar: salaire en cas de succ√®s
    - w: salaire en cas d'√©chec
    - pi_H: probabilit√© de succ√®s avec effort √©lev√© H
    - pi_B: probabilit√© de succ√®s avec effort faible B
    - d_H: d√©sutilit√© de l'effort √©lev√©
    - d_B: d√©sutilit√© de l'effort faible
    - u_r: utilit√© de r√©serve de l'agent
    """
    
    def __init__(self, q_bar=100, q=20, pi_H=0.8, pi_B=0.4, 
                 d_H=15, d_B=5, u_r=10, gamma=0.5):
        """
        Initialisation des param√®tres du mod√®le
        
        Args:
            q_bar: profit en cas de succ√®s
            q: profit en cas d'√©chec
            pi_H: probabilit√© de succ√®s avec effort √©lev√©
            pi_B: probabilit√© de succ√®s avec effort faible
            d_H: d√©sutilit√© effort √©lev√©
            d_B: d√©sutilit√© effort faible
            u_r: utilit√© de r√©serve
            gamma: coefficient d'aversion au risque (0 < gamma ‚â§ 1)
        """
        # V√©rifications des param√®tres
        assert q_bar > q, "Le profit en cas de succ√®s doit √™tre > profit en cas d'√©chec"
        assert 0 < pi_B < pi_H < 1, "Condition: 0 < pi_B < pi_H < 1"
        assert d_H > d_B >= 0, "Le co√ªt de l'effort √©lev√© doit √™tre > effort faible"
        assert 0 < gamma <= 1, "Coefficient d'aversion au risque: 0 < gamma ‚â§ 1"
        
        self.q_bar = q_bar
        self.q = q
        self.pi_H = pi_H
        self.pi_B = pi_B
        self.d_H = d_H
        self.d_B = d_B
        self.u_r = u_r
        self.gamma = gamma
        
    def utility_agent(self, w: float) -> float:
        """
        Fonction d'utilit√© de l'agent: u(w) = w^gamma
        
        Args:
            w: salaire
        Returns:
            Utilit√© de l'agent
        """
        return w**self.gamma if w >= 0 else -np.inf
    
    def expected_utility_agent(self, w_bar: float, w: float, effort: str) -> float:
        """
        Utilit√© esp√©r√©e de l'agent: E[u(w(y))] - d_e
        
        Args:
            w_bar: salaire en cas de succ√®s
            w: salaire en cas d'√©chec
            effort: 'H' (√©lev√©) ou 'B' (faible)
        Returns:
            Utilit√© esp√©r√©e de l'agent
        """
        pi = self.pi_H if effort == 'H' else self.pi_B
        d = self.d_H if effort == 'H' else self.d_B
        
        return pi * self.utility_agent(w_bar) + (1 - pi) * self.utility_agent(w) - d
    
    def expected_profit_principal(self, w_bar: float, w: float, effort: str) -> float:
        """
        Profit esp√©r√© du principal: E[q(y) - w(y)]
        
        Args:
            w_bar: salaire en cas de succ√®s
            w: salaire en cas d'√©chec
            effort: 'H' ou 'B'
        Returns:
            Profit esp√©r√© du principal
        """
        pi = self.pi_H if effort == 'H' else self.pi_B
        
        return pi * (self.q_bar - w_bar) + (1 - pi) * (self.q - w)
```

### R√©solution du first-best

# üìó Fonction `solve_first_best`

### Description g√©n√©rale

La fonction `solve_first_best` r√©sout le probl√®me du principal dans le cas **first-best**, c‚Äôest-√†-dire lorsque l‚Äôeffort de l‚Äôagent est parfaitement observable. Dans ce contexte, le principal peut imposer directement le niveau d‚Äôeffort et offrir une **assurance compl√®te** √† l‚Äôagent.

### Arguments

* `model` : instance de la classe `PrincipalAgentModel`.
* `target_effort` : effort √† imposer (`'H'` ou `'B'`).


### Sorties

La fonction retourne un dictionnaire contenant :

* `effort` : effort impos√©,
* `w_bar` : salaire en cas de succ√®s,
* `w` : salaire en cas d‚Äô√©chec,
* `profit_principal` : profit esp√©r√© du principal,
* `utility_agent` : utilit√© nette de l‚Äôagent,
* `type` : type de r√©gime (`First-Best`).

### Logique √©conomique

Dans le first-best :

* le principal impose l‚Äôeffort optimal,
* la contrainte de participation est **satur√©e**,
* le salaire est identique dans tous les √©tats (( wÃÑ = w )),
* l‚Äôagent re√ßoit exactement son utilit√© de r√©serve.

L‚Äôutilit√© de l‚Äôagent ne varie donc pas et reste √©gale √† ( u_r ), tandis que le salaire s‚Äôajuste pour compenser la d√©sutilit√© de l‚Äôeffort.


```python
def solve_first_best(model: PrincipalAgentModel, target_effort: str = 'H', verbose=True) -> Dict:
    """
    R√©solution du cas first-best (effort observable)
    
    Le principal peut imposer directement l'effort et assurer compl√®tement
    l'agent (w_bar = w) car il est averse au risque.
    
    Args:
        model: instance du mod√®le
        target_effort: 'H' ou 'B' - effort √† imposer
    Returns:
        dict avec contrat optimal et profits
    """
    print("\n" + "-"*50)
    print("R√©solution du first best (Information Sym√©trique)")
    print("-"*50)

    d = model.d_H if target_effort == 'H' else model.d_B
    pi = model.pi_H if target_effort == 'H' else model.pi_B
    
    # Salaire optimal: w_bar = w (assurance compl√®te)
    # Contrainte de participation satur√©e: u(w) - d = u_r
    w_optimal = (model.u_r + d)**(1/model.gamma)
    w_bar_optimal = w_optimal
    
    # Profit esp√©r√© du principal
    profit_principal = model.expected_profit_principal(
        w_bar_optimal, w_optimal, target_effort
    )
    
    # Utilit√© de l'agent
    utility_agent = model.expected_utility_agent(
        w_bar_optimal, w_optimal, target_effort
    )
    
    print(f"\nEffort impos√©: {target_effort}")
    print(f"Probabilit√© de succ√®s: œÄ_{target_effort} = {pi:.2f}")
    print(f"\nContrat optimal (assurance compl√®te):")
    print(f"  wÃÑ (succ√®s) = w (√©chec) = {w_optimal:.2f}")
    print(f"\nR√©sultats:")
    print(f"  Profit esp√©r√© Principal: {profit_principal:.2f}")
    print(f"  Utilit√© Agent: {utility_agent:.2f} (= u_r = {model.u_r:.2f})")
    
    # Comparaison des efforts
    if target_effort == 'H':
        w_B = (model.u_r + model.d_B)**(1/model.gamma)
        profit_B = model.expected_profit_principal(w_B, w_B, 'B')
        
        print(f"\nComparaison:")
        print(f"  Si effort H impos√©: Profit = {profit_principal:.2f}")
        print(f"  Si effort B impos√©: Profit = {profit_B:.2f}")
        
        if profit_principal > profit_B:
            print(f" Le principal pr√©f√®re imposer l'effort H")
        else:
            print(f" Le principal pr√©f√®re imposer l'effort B")
    
    return {
        'effort': target_effort,
        'w_bar': w_bar_optimal,
        'w': w_optimal,
        'profit_principal': profit_principal,
        'utility_agent': utility_agent,
        'type': 'First-Best'
    }
```

### R√©solution du second-best

# üìô Fonction `solve_second_best`

### Description g√©n√©rale

La fonction `solve_second_best` r√©sout le probl√®me du principal dans le cas **second-best**, o√π l‚Äôeffort de l‚Äôagent n‚Äôest pas observable. Le principal doit alors concevoir un contrat incitatif respectant simultan√©ment la contrainte de participation et la contrainte d‚Äôincitation.

### Arguments

* `model` : instance de `PrincipalAgentModel`.

### Sorties

La fonction retourne un dictionnaire contenant :

* `w_bar` : salaire en cas de succ√®s,
* `w` : salaire en cas d‚Äô√©chec,
* `profit_principal` : profit esp√©r√© du principal,
* `utility_agent_H` : utilit√© de l‚Äôagent s‚Äôil choisit l‚Äôeffort √©lev√©,
* `utility_agent_B` : utilit√© de l‚Äôagent s‚Äôil choisit l‚Äôeffort faible,
* `CP` : valeur de la contrainte de participation,
* `CI` : valeur de la contrainte d‚Äôincitation,
* `type` : type de r√©gime (`Second-Best`).

### Logique √©conomique

Dans le second-best :

* le principal introduit une **variabilit√© des salaires** (( wÃÑ > w)),
* l‚Äôagent supporte un risque pour √™tre incit√© √† fournir l‚Äôeffort √©lev√©,
* les contraintes sont g√©n√©ralement **satur√©es**,
* un **co√ªt d‚Äôagence** appara√Æt par rapport au first-best.


```python
def solve_second_best(model: PrincipalAgentModel, verbose=True) -> Dict:
    """
    R√©solution du cas second-best (al√©a moral - effort non observable)
    
    Le principal doit satisfaire:
    1. Contrainte de Participation (CP): EU_A(H) ‚â• u_r
    2. Contrainte d'Incitation (CI): EU_A(H) ‚â• EU_A(B)
    
    Args:
        model: instance du mod√®le
    Returns:
        dict avec contrat optimal et profits
    """
    print("\n" + "-"*40)
    print("R√©solution du second best (Al√©a Moral)")
    print("-"*40)

    def objective(x):
        """Fonction √† minimiser: -Profit du Principal"""
        w_bar, w = x
        if w_bar < 0 or w < 0:
            return 1e10
        return -model.expected_profit_principal(w_bar, w, 'H')
    
    def constraint_participation(x):
        """Contrainte de Participation (CP): EU_A(H) - u_r ‚â• 0"""
        w_bar, w = x
        return model.expected_utility_agent(w_bar, w, 'H') - model.u_r
    
    def constraint_incentive(x):
        """Contrainte d'Incitation (CI): EU_A(H) - EU_A(B) ‚â• 0"""
        w_bar, w = x
        eu_H = model.expected_utility_agent(w_bar, w, 'H')
        eu_B = model.expected_utility_agent(w_bar, w, 'B')
        return eu_H - eu_B
    
    # Contraintes
    constraints = [
        {'type': 'ineq', 'fun': constraint_participation},
        {'type': 'ineq', 'fun': constraint_incentive}
    ]
    
    # Point initial
    w_init = (model.u_r + model.d_H)**(1/model.gamma)
    x0 = [w_init * 1.5, w_init * 0.8]
    
    # Optimisation
    result = minimize(
        objective,
        x0,
        method='SLSQP',
        bounds=[(0, None), (0, None)],
        constraints=constraints,
        options={'ftol': 1e-9, 'maxiter': 1000}
    )
    
    if not result.success:
        print("Attention: L'optimisation n'a pas converg√©!")
        print(f"Message: {result.message}")
    
    w_bar_opt, w_opt = result.x
    
    # Calcul des r√©sultats
    profit_principal = model.expected_profit_principal(w_bar_opt, w_opt, 'H')
    utility_agent_H = model.expected_utility_agent(w_bar_opt, w_opt, 'H')
    utility_agent_B = model.expected_utility_agent(w_bar_opt, w_opt, 'B')
    
    # V√©rification des contraintes
    cp_slack = utility_agent_H - model.u_r
    ci_slack = utility_agent_H - utility_agent_B
    
    print(f"\nContrat optimal:")
    print(f"  wÃÑ (succ√®s) = {w_bar_opt:.2f}")
    print(f"  w (√©chec)  = {w_opt:.2f}")
    print(f"  √âcart wÃÑ - w = {w_bar_opt - w_opt:.2f}")
    
    print(f"\nR√©sultats:")
    print(f"  Profit esp√©r√© Principal: {profit_principal:.2f}")
    print(f"  Utilit√© Agent (si e=H): {utility_agent_H:.2f}")
    print(f"  Utilit√© Agent (si e=B): {utility_agent_B:.2f}")
    
    print(f"\nV√©rification des contraintes:")
    print(f"  CP (‚â• 0): {cp_slack:.4f} {' contrainte satur√©e' if abs(cp_slack) < 0.01 else '‚úì'}")
    print(f"  CI (‚â• 0): {ci_slack:.4f} {' contrainte satur√©e' if abs(ci_slack) < 0.01 else '‚úì'}")

    print(f"\nInterpr√©tation:")
    if w_bar_opt > w_opt:
        print(f"  L'agent est incit√© √† fournir l'effort √©lev√© H")
        print(f"  Mais il supporte du risque (wÃÑ ‚â† w)")
    
    return {
        'effort': 'H',
        'w_bar': w_bar_opt,
        'w': w_opt,
        'profit_principal': profit_principal,
        'utility_agent': utility_agent_H,
        'type': 'Second-Best',
        'cp_slack': cp_slack,
        'ci_slack': ci_slack
    }
```

### V√©rification de l'√©quilibre parfairt bay√©sien

# üìï Fonction de v√©rification du PBE

### Description g√©n√©rale

La fonction de v√©rification du PBE teste si le contrat issu du second-best constitue un **√©quilibre bay√©sien parfait**. Elle v√©rifie successivement la rationalit√© de l‚Äôagent, la coh√©rence des croyances du principal et l‚Äôabsence de d√©viation profitable.


```python
def verify_perfect_bayesian_equilibrium(model: PrincipalAgentModel, 
                                       contract: Dict) -> Dict:
    """
    V√©rifie que la solution constitue un √âquilibre Bay√©sien Parfait (PBE)
    
    Un PBE requiert:
    1. Optimalit√© s√©quentielle: chaque joueur optimise √† chaque n≈ìud de d√©cision
    2. Croyances bay√©siennes: coh√©rentes avec les strat√©gies d'√©quilibre
    3. Pas de d√©viation profitable
    
    Args:
        model: instance du mod√®le
        contract: dictionnaire avec w_bar et w
    Returns:
        dict avec r√©sultats de v√©rification
    """
    print("\n" + "-"*50)
    print("V√©rification de l'√©quilibre bay√©sien parfait (PBE)")
    print("-"*50)
    
    w_bar = contract['w_bar']
    w = contract['w']
    
    # ==== 1. RATIONALIT√â S√âQUENTIELLE DE L'AGENT ====
    print("\n1. V√©rification de la rationalit√© de l'Agent:")
    
    # Utilit√©s pour chaque effort
    eu_H = model.expected_utility_agent(w_bar, w, 'H')
    eu_B = model.expected_utility_agent(w_bar, w, 'B')
    eu_reject = model.u_r  # Utilit√© si refus
    
    print(f"   EU_A(accepter, e=H) = {eu_H:.4f}")
    print(f"   EU_A(accepter, e=B) = {eu_B:.4f}")
    print(f"   EU_A(refuser)       = {eu_reject:.4f}")
    
    # D√©cision de participation
    accept_contract = max(eu_H, eu_B) >= eu_reject
    print(f"\n   ‚Üí L'agent {'Accepte' if accept_contract else 'Refuse'} le contrat")
    
    # Choix d'effort optimal
    if accept_contract:
        optimal_effort = 'H' if eu_H >= eu_B else 'B'
        print(f"  Si accept√©, effort optimal: {optimal_effort}")
        
        ic_satisfied = eu_H >= eu_B
        print(f"  Contrainte d'incitation: {'SATISFAITE' if ic_satisfied else 'VIOL√âE'}")
    
    # ==== 2. CROYANCES DU PRINCIPAL ====
    print("\n2. Croyances du Principal (apr√®s observation du r√©sultat):")
    
    # Probabilit√©s a priori
    print(f"   Croyances a priori (avant observation):")
    print(f"     P(e=H | contrat propos√©) = 1 (anticip√©)")
    print(f"     P(e=B | contrat propos√©) = 0")
    
    # Mise √† jour bay√©sienne apr√®s observation du succ√®s
    if accept_contract and optimal_effort == 'H':
        # Probabilit√© de succ√®s observ√© sachant e=H
        p_success_given_H = model.pi_H
        # Probabilit√© de succ√®s observ√© sachant e=B
        p_success_given_B = model.pi_B
        
        # R√®gle de Bayes: P(H|S) = P(S|H)*P(H) / P(S)
        # Si le principal anticipe correctement e=H
        prob_H_given_success = (p_success_given_H * 1.0) / p_success_given_H
        prob_H_given_failure = ((1-p_success_given_H) * 1.0) / (1-p_success_given_H)
        
        print(f"\n   Mise √† jour bay√©sienne:")
        print(f"     P(e=H | Succ√®s observ√©) = {prob_H_given_success:.4f}")
        print(f"     P(e=H | √âchec observ√©)  = {prob_H_given_failure:.4f}")
        print(f"     Croyances coh√©rentes avec strat√©gie d'√©quilibre")
    
    # ==== 3. OPTIMALIT√â DU PRINCIPAL ====
    print("\n3. V√©rification de l'optimalit√© du Principal:")
    
    profit_equilibrium = model.expected_profit_principal(w_bar, w, optimal_effort if accept_contract else 'B')
    print(f"   Profit √† l'√©quilibre: {profit_equilibrium:.4f}")
    
    # Test de d√©viations possibles
    print(f"\n   Test de d√©viations:")
    
    # D√©viation 1: offrir un contrat qui induit e=B
    w_B_deviation = (model.u_r + model.d_B)**(1/model.gamma)
    profit_deviation_B = model.expected_profit_principal(w_B_deviation, w_B_deviation, 'B')
    print(f"     D√©viation vers e=B: Profit = {profit_deviation_B:.4f}")
    
    # D√©viation 2: ne pas proposer de contrat
    profit_no_contract = 0
    print(f"     Ne pas contracter: Profit = {profit_no_contract:.4f}")
    
    no_profitable_deviation = (profit_equilibrium >= profit_deviation_B) and (profit_equilibrium >= profit_no_contract)
    print(f"\n   Pas de d√©viation profitable: {'OUI' if no_profitable_deviation else 'NON'}")
    
    # ==== 4. TEST DE ROBUSTESSE ====
    print("\n4. Tests de robustesse:")
    
    # Test 1: Si le principal augmente w_bar
    w_bar_test = w_bar * 1.1
    eu_H_test = model.expected_utility_agent(w_bar_test, w, 'H')
    eu_B_test = model.expected_utility_agent(w_bar_test, w, 'B')
    profit_test = model.expected_profit_principal(w_bar_test, w, 'H')
    
    print(f"   Si wÃÑ augmente de 10%:")
    print(f"     CI reste satisfaite: {eu_H_test >= eu_B_test}")
    print(f"     Profit Principal: {profit_test:.4f} {'<' if profit_test < profit_equilibrium else '‚â•'} {profit_equilibrium:.4f}")
    
    # Test 2: Si le principal diminue w_bar
    w_bar_test2 = w_bar * 0.9
    eu_H_test2 = model.expected_utility_agent(w_bar_test2, w, 'H')
    eu_B_test2 = model.expected_utility_agent(w_bar_test2, w, 'B')
    
    print(f"\n   Si wÃÑ diminue de 10%:")
    print(f"     CI satisfaite: {eu_H_test2 >= eu_B_test2}")
    print(f"     CP satisfaite: {eu_H_test2 >= model.u_r}")
    
    # ==== CONCLUSION ====
    print("\n" + "-"*50)
    print("Conclusion sur l'√âquilibre Bay√©sien Parfait:")
    print("-"*50)
    
    is_pbe = accept_contract and ic_satisfied and no_profitable_deviation
    
    if is_pbe:
        print("PBE v√©rifi√©")    
        print("\nLe contrat propos√© constitue un PBE car:")
        print("  1. L'agent accepte et choisit rationnellement e=H")
        print("  2. Les croyances du principal sont coh√©rentes")
        print("  3. Aucun joueur ne peut d√©vier de mani√®re profitable")
    else:
        print("Pas de PBE")
    
    return {
        'is_pbe': is_pbe,
        'agent_accepts': accept_contract,
        'optimal_effort': optimal_effort if accept_contract else None,
        'ic_satisfied': ic_satisfied if accept_contract else False,
        'no_profitable_deviation': no_profitable_deviation,
        'equilibrium_profit': profit_equilibrium,
        'eu_H': eu_H,
        'eu_B': eu_B
    }
```

### Comparaison et analyse des deux situations

#  Analyse de sensibilit√©

## Objectif g√©n√©ral

L‚Äôanalyse de sensibilit√© vise √† √©tudier la robustesse des r√©sultats du mod√®le principal‚Äìagent face aux variations de certains param√®tres cl√©s. Elle permet de comprendre comment les **incitations**, le **co√ªt d‚Äôagence** et la **rentabilit√© du principal** r√©agissent lorsque l‚Äôenvironnement √©conomique change. Deux param√®tres centraux sont analys√©s :

* l‚Äôaversion au risque de l‚Äôagent (Œ≥),
* la productivit√© de l‚Äôeffort faible (œÄ_B).


## Sensibilit√© √† l‚Äôaversion au risque de l‚Äôagent (Œ≥)

### Description

Le param√®tre Œ≥ mesure le degr√© d‚Äôaversion au risque de l‚Äôagent. Plus Œ≥ est faible, plus l‚Äôagent est averse au risque ; √† l‚Äôinverse, lorsque Œ≥ se rapproche de 1, l‚Äôagent devient neutre au risque. L‚Äôanalyse consiste √† faire varier Œ≥ sur un intervalle donn√© et √† r√©soudre successivement les probl√®mes first-best et second-best pour chaque valeur.


### Logique √©conomique

Lorsque l‚Äôagent est tr√®s averse au risque (Œ≥ faible), le principal doit offrir une forte assurance pour satisfaire la contrainte de participation. Cela conduit √† des salaires √©lev√©s et peut fortement r√©duire, voire annuler, le profit du principal. Dans ce cas, inciter l‚Äôagent √† fournir un effort √©lev√© devient co√ªteux.

√Ä mesure que Œ≥ augmente :

* l‚Äôagent supporte mieux le risque,
* l‚Äô√©cart entre le salaire en cas de succ√®s et d‚Äô√©chec diminue,
* le co√ªt d‚Äôagence d√©cro√Æt progressivement.

### R√©sultats observ√©s

* Pour des valeurs faibles de Œ≥, le profit du principal peut devenir n√©gatif et le principal pr√©f√®re parfois imposer l‚Äôeffort faible.
* Lorsque Œ≥ augmente, le contrat incitatif devient moins co√ªteux.
* √Ä la limite Œ≥ = 1 (agent neutre au risque), le second-best co√Øncide avec le first-best et le co√ªt d‚Äôagence devient nul.


### Interpr√©tation √©conomique

Cette analyse confirme un r√©sultat fondamental de la th√©orie du principal‚Äìagent : **le co√ªt d‚Äôagence est d‚Äôautant plus √©lev√© que l‚Äôagent est averse au risque**. Lorsque l‚Äôagent est neutre au risque, il est possible de l‚Äôinciter sans perte d‚Äôefficacit√©, ce qui √©limine toute inefficience li√©e √† l‚Äôasym√©trie d‚Äôinformation.


## Sensibilit√© √† la probabilit√© de succ√®s sous effort faible (œÄ_B)

### Description

La probabilit√© œÄ_B mesure l‚Äôefficacit√© de l‚Äôeffort faible. L‚Äôanalyse de sensibilit√© consiste √† augmenter progressivement œÄ_B tout en maintenant œÄ_H constant, afin d‚Äô√©valuer comment la proximit√© entre les deux niveaux d‚Äôeffort affecte la structure du contrat et le choix du principal.


### Logique √©conomique

Lorsque œÄ_B est faible, l‚Äôeffort √©lev√© apporte un gain productif important par rapport √† l‚Äôeffort faible. Le principal est alors pr√™t √† supporter un co√ªt d‚Äôincitation pour encourager l‚Äôeffort √©lev√©. En revanche, lorsque œÄ_B augmente, la diff√©rence entre les deux efforts se r√©duit, ce qui diminue l‚Äôint√©r√™t √©conomique d‚Äôinciter l‚Äôagent √† fournir l‚Äôeffort √©lev√©.


### R√©sultats observ√©s

* √Ä mesure que œÄ_B augmente, l‚Äô√©cart salarial ( wÃÑ - w ) n√©cessaire pour inciter l‚Äôeffort √©lev√© augmente.
* Le profit du principal diminue, refl√©tant une hausse du co√ªt d‚Äôagence.
* Au-del√† d‚Äôun certain seuil, le principal pr√©f√®re abandonner l‚Äôeffort √©lev√© et choisir directement l‚Äôeffort faible.
* Dans certains cas extr√™mes, la contrainte d‚Äôincitation devient plus contraignante que la contrainte de participation, ce qui conduit √† une **rente informationnelle** pour l‚Äôagent.


### Interpr√©tation √©conomique

Cette analyse montre que **l‚Äôincitation √† l‚Äôeffort √©lev√© n‚Äôest rentable que si l‚Äôeffort faible est suffisamment inefficace**. Lorsque les performances des deux efforts deviennent proches, l‚Äôasym√©trie d‚Äôinformation engendre une inefficience trop importante, et le principal renonce √† l‚Äôeffort √©lev√©.


## Co√ªt d‚Äôagence et enseignements g√©n√©raux

### D√©finition

Le co√ªt d‚Äôagence est d√©fini comme la diff√©rence de profit entre le r√©gime first-best et le r√©gime second-best :

$$
\text{Co√ªt d‚Äôagence} = \Pi^{FB} - \Pi^{SB}
$$



### R√©sultats globaux

* Le co√ªt d‚Äôagence augmente lorsque :

  * l‚Äôagent est tr√®s averse au risque,
  * l‚Äôeffort faible devient plus productif.
* Le co√ªt d‚Äôagence tend vers z√©ro lorsque :

  * l‚Äôagent est neutre au risque,
  * l‚Äôeffort √©lev√© domine largement l‚Äôeffort faible.


### Interpr√©tation synth√©tique

L‚Äôanalyse de sensibilit√© met en √©vidence le compromis central du mod√®le principal‚Äìagent : **inciter un agent sous asym√©trie d‚Äôinformation implique n√©cessairement un co√ªt**, dont l‚Äôampleur d√©pend √† la fois des pr√©f√©rences de l‚Äôagent et de la technologie de production.


```python
def compare_regimes(model: PrincipalAgentModel) -> Tuple[Dict, Dict, float]:
    """
    Compare les r√©sultats First-Best vs Second-Best
    
    Args:
        model: instance du mod√®le
    Returns:
        tuple (first_best, second_best, agency_cost)
    """
    print("\n" + "="*50)
    print("Comparaison des r√©gimes First-Best vs Second-Best")
    print("="*50)
    
    fb = solve_first_best(model, 'H')
    sb = solve_second_best(model)
    
    # Co√ªt d'agence
    agency_cost = fb['profit_principal'] - sb['profit_principal']
    
    print(f"\nCo√ªt d'agence (perte due √† l'asym√©trie d'information):")
    print(f"  Profit FB - Profit SB = {agency_cost:.2f}")
    print(f"  Perte relative: {100 * agency_cost / fb['profit_principal']:.2f}%")
    
    print(f"\n√âcart de salaire:")
    print(f"  FB: wÃÑ - w = {fb['w_bar'] - fb['w']:.2f} (assurance compl√®te)")
    print(f"  SB: wÃÑ - w = {sb['w_bar'] - sb['w']:.2f} (incitation)")
    
    return fb, sb, agency_cost
```

### Analyse de sensibilit√©


```python
def sensitivity_analysis(model: PrincipalAgentModel):
    """
    Analyse de sensibilit√©: impact des param√®tres sur le co√ªt d'agence
    
    Args:
        model: instance du mod√®le
    Returns:
        figure matplotlib
    """
    print("\n" + "="*40)
    print("Analyse de sensibilit√© du co√ªt d'agence")
    print("="*40)
    
    # Sauvegarder param√®tres originaux
    original_gamma = model.gamma
    original_pi_B = model.pi_B
    
    # Analyse 1: Impact de l'aversion au risque (gamma)
    gammas = np.linspace(0.3, 1.0, 8)
    agency_costs_gamma = []
    
    print("\n1. Impact de l'aversion au risque (Œ≥):")
    for g in gammas:
        model.gamma = g
        fb = solve_first_best(model, 'H')
        sb = solve_second_best(model)
        ac = fb['profit_principal'] - sb['profit_principal']
        agency_costs_gamma.append(ac)
        print(f"   Œ≥ = {g:.2f}: Co√ªt d'agence = {ac:.2f}")
    
    # Analyse 2: Impact de pi_B
    model.gamma = original_gamma
    pi_Bs = np.linspace(0.2, 0.7, 8)
    agency_costs_pi = []
    
    print("\n2. Impact de œÄ_B (effort faible):")
    for pi_b in pi_Bs:
        if pi_b < model.pi_H:
            model.pi_B = pi_b
            fb = solve_first_best(model, 'H')
            sb = solve_second_best(model)
            ac = fb['profit_principal'] - sb['profit_principal']
            agency_costs_pi.append(ac)
            print(f"   œÄ_B = {pi_b:.2f}: Co√ªt d'agence = {ac:.2f}")
    
    # Restaurer param√®tres
    model.gamma = original_gamma
    model.pi_B = original_pi_B
    
    # Graphiques
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))
    
    ax1.plot(gammas, agency_costs_gamma, 'b-o', linewidth=2, markersize=8)
    ax1.set_xlabel('Coefficient d\'aversion au risque (Œ≥)', fontsize=12)
    ax1.set_ylabel('Co√ªt d\'agence', fontsize=12)
    ax1.set_title('Impact de l\'aversion au risque', fontsize=13, fontweight='bold')
    ax1.grid(True, alpha=0.3)
    ax1.axhline(y=0, color='r', linestyle='--', alpha=0.5)
    
    ax2.plot(pi_Bs[:len(agency_costs_pi)], agency_costs_pi, 'g-o', linewidth=2, markersize=8)
    ax2.set_xlabel('Probabilit√© de succ√®s avec effort faible (œÄ_B)', fontsize=12)
    ax2.set_ylabel('Co√ªt d\'agence', fontsize=12)
    ax2.set_title('Impact de la difficult√© de surveillance', fontsize=13, fontweight='bold')
    ax2.grid(True, alpha=0.3)
    ax2.axhline(y=0, color='r', linestyle='--', alpha=0.5)
    
    plt.tight_layout()
    
    return fig
```

### Exemple d'utilisation


```python
# 1. Cr√©ation du mod√®le
model = PrincipalAgentModel(
    q_bar=600,    # Profit si succ√®s
    q=100,         # Profit si √©chec
    pi_H=0.7,     # pi_B=0.7 Proba succ√®s si effort faible  pi_H=0.7 donne le PBE
    pi_B=0.3,     # pi_B=0.3 Proba succ√®s si effort faible  pi_B=0.3 donne le PBE
    d_H=5,        # Co√ªt effort √©lev√©
    d_B=2,        # Co√ªt effort faible
    u_r=10,       # Utilit√© de r√©serve
    gamma=0.5     # Aversion au risque
)

# 2. R√©soudre First-Best
fb = solve_first_best(model, 'H')

# 3. R√©soudre Second-Best
sb = solve_second_best(model)

# 4. V√©rifier l'√©quilibre bay√©sien
pbe_results = verify_perfect_bayesian_equilibrium(model, sb)

# 5. Comparer les r√©gimes
fb, sb, agency_cost = compare_regimes(model)

# 6. Analyse de sensibilit√©
fig = sensitivity_analysis(model)
plt.show()
```

    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 106.00
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 297.56
      w (√©chec)  = 95.06
      √âcart wÃÑ - w = 202.50
    
    R√©sultats:
      Profit esp√©r√© Principal: 213.19
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): -0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
    
    --------------------------------------------------
    V√©rification de l'√©quilibre bay√©sien parfait (PBE)
    --------------------------------------------------
    
    1. V√©rification de la rationalit√© de l'Agent:
       EU_A(accepter, e=H) = 10.0000
       EU_A(accepter, e=B) = 10.0000
       EU_A(refuser)       = 10.0000
    
       ‚Üí L'agent Refuse le contrat
    
    2. Croyances du Principal (apr√®s observation du r√©sultat):
       Croyances a priori (avant observation):
         P(e=H | contrat propos√©) = 1 (anticip√©)
         P(e=B | contrat propos√©) = 0
    
    3. V√©rification de l'optimalit√© du Principal:
       Profit √† l'√©quilibre: 94.1875
    
       Test de d√©viations:
         D√©viation vers e=B: Profit = 106.0000
         Ne pas contracter: Profit = 0.0000
    
       Pas de d√©viation profitable: NON
    
    4. Tests de robustesse:
       Si wÃÑ augmente de 10%:
         CI reste satisfaite: True
         Profit Principal: 192.3581 ‚â• 94.1875
    
       Si wÃÑ diminue de 10%:
         CI satisfaite: False
         CP satisfaite: False
    
    --------------------------------------------------
    Conclusion sur l'√âquilibre Bay√©sien Parfait:
    --------------------------------------------------
    Pas de PBE
    
    ==================================================
    Comparaison des r√©gimes First-Best vs Second-Best
    ==================================================
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 106.00
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 297.56
      w (√©chec)  = 95.06
      √âcart wÃÑ - w = 202.50
    
    R√©sultats:
      Profit esp√©r√© Principal: 213.19
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): -0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
    
    Co√ªt d'agence (perte due √† l'asym√©trie d'information):
      Profit FB - Profit SB = 11.81
      Perte relative: 5.25%
    
    √âcart de salaire:
      FB: wÃÑ - w = 0.00 (assurance compl√®te)
      SB: wÃÑ - w = 202.50 (incitation)
    
    ========================================
    Analyse de sensibilit√© du co√ªt d'agence
    ========================================
    
    1. Impact de l'aversion au risque (Œ≥):
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 8323.47
    
    R√©sultats:
      Profit esp√©r√© Principal: -7873.47
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = -7873.47
      Si effort B impos√©: Profit = -3706.13
     Le principal pr√©f√®re imposer l'effort B
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 13262.65
      w (√©chec)  = 1980.08
      √âcart wÃÑ - w = 11282.57
    
    R√©sultats:
      Profit esp√©r√© Principal: -9427.88
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): -0.0000  contrainte satur√©e
      CI (‚â• 0): -0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       Œ≥ = 0.30: Co√ªt d'agence = 1554.41
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 871.42
    
    R√©sultats:
      Profit esp√©r√© Principal: -421.42
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = -421.42
      Si effort B impos√©: Profit = -248.83
     Le principal pr√©f√®re imposer l'effort B
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 1235.87
      w (√©chec)  = 296.83
      √âcart wÃÑ - w = 939.04
    
    R√©sultats:
      Profit esp√©r√© Principal: -504.16
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): 0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       Œ≥ = 0.40: Co√ªt d'agence = 82.74
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 106.00
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 297.56
      w (√©chec)  = 95.06
      √âcart wÃÑ - w = 202.50
    
    R√©sultats:
      Profit esp√©r√© Principal: 213.19
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): -0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       Œ≥ = 0.50: Co√ªt d'agence = 11.81
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 91.23
    
    R√©sultats:
      Profit esp√©r√© Principal: 358.77
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 358.77
      Si effort B impos√©: Profit = 187.10
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 115.16
      w (√©chec)  = 44.50
      √âcart wÃÑ - w = 70.67
    
    R√©sultats:
      Profit esp√©r√© Principal: 356.04
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): -0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       Œ≥ = 0.60: Co√ªt d'agence = 2.73
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 47.88
    
    R√©sultats:
      Profit esp√©r√© Principal: 402.12
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 402.12
      Si effort B impos√©: Profit = 215.19
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 58.46
      w (√©chec)  = 25.87
      √âcart wÃÑ - w = 32.58
    
    R√©sultats:
      Profit esp√©r√© Principal: 401.32
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): 0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       Œ≥ = 0.70: Co√ªt d'agence = 0.81
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 29.52
    
    R√©sultats:
      Profit esp√©r√© Principal: 420.48
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 420.48
      Si effort B impos√©: Profit = 227.67
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 35.15
      w (√©chec)  = 17.23
      √âcart wÃÑ - w = 17.93
    
    R√©sultats:
      Profit esp√©r√© Principal: 420.22
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): 0.0000  contrainte satur√©e
      CI (‚â• 0): -0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       Œ≥ = 0.80: Co√ªt d'agence = 0.26
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 20.27
    
    R√©sultats:
      Profit esp√©r√© Principal: 429.73
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 429.73
      Si effort B impos√©: Profit = 234.18
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 23.67
      w (√©chec)  = 12.56
      √âcart wÃÑ - w = 11.11
    
    R√©sultats:
      Profit esp√©r√© Principal: 429.66
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): 0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       Œ≥ = 0.90: Co√ªt d'agence = 0.07
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 15.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 435.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 435.00
      Si effort B impos√©: Profit = 238.00
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 17.25
      w (√©chec)  = 9.75
      √âcart wÃÑ - w = 7.50
    
    R√©sultats:
      Profit esp√©r√© Principal: 435.00
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): -0.0000  contrainte satur√©e
      CI (‚â• 0): -0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       Œ≥ = 1.00: Co√ªt d'agence = -0.00
    
    2. Impact de œÄ_B (effort faible):
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 56.00
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 282.24
      w (√©chec)  = 116.64
      √âcart wÃÑ - w = 165.60
    
    R√©sultats:
      Profit esp√©r√© Principal: 217.44
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): -0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       œÄ_B = 0.20: Co√ªt d'agence = 7.56
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 91.71
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 292.41
      w (√©chec)  = 102.01
      √âcart wÃÑ - w = 190.40
    
    R√©sultats:
      Profit esp√©r√© Principal: 214.71
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): 0.0000  contrainte satur√©e
      CI (‚â• 0): -0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       œÄ_B = 0.27: Co√ªt d'agence = 10.29
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 127.43
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 306.95
      w (√©chec)  = 83.17
      √âcart wÃÑ - w = 223.78
    
    R√©sultats:
      Profit esp√©r√© Principal: 210.18
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): 0.0000  contrainte satur√©e
      CI (‚â• 0): -0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       œÄ_B = 0.34: Co√ªt d'agence = 14.82
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 163.14
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 329.42
      w (√©chec)  = 58.52
      √âcart wÃÑ - w = 270.90
    
    R√©sultats:
      Profit esp√©r√© Principal: 201.85
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): -0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       œÄ_B = 0.41: Co√ªt d'agence = 23.15
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 198.86
     Le principal pr√©f√®re imposer l'effort H
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 368.64
      w (√©chec)  = 27.04
      √âcart wÃÑ - w = 341.60
    
    R√©sultats:
      Profit esp√©r√© Principal: 183.84
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): 0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       œÄ_B = 0.49: Co√ªt d'agence = 41.16
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 234.57
     Le principal pr√©f√®re imposer l'effort B
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 453.69
      w (√©chec)  = 0.09
      √âcart wÃÑ - w = 453.60
    
    R√©sultats:
      Profit esp√©r√© Principal: 132.39
      Utilit√© Agent (si e=H): 10.00
      Utilit√© Agent (si e=B): 10.00
    
    V√©rification des contraintes:
      CP (‚â• 0): 0.0000  contrainte satur√©e
      CI (‚â• 0): 0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       œÄ_B = 0.56: Co√ªt d'agence = 92.61
    
    --------------------------------------------------
    R√©solution du first best (Information Sym√©trique)
    --------------------------------------------------
    
    Effort impos√©: H
    Probabilit√© de succ√®s: œÄ_H = 0.70
    
    Contrat optimal (assurance compl√®te):
      wÃÑ (succ√®s) = w (√©chec) = 225.00
    
    R√©sultats:
      Profit esp√©r√© Principal: 225.00
      Utilit√© Agent: 10.00 (= u_r = 10.00)
    
    Comparaison:
      Si effort H impos√©: Profit = 225.00
      Si effort B impos√©: Profit = 270.29
     Le principal pr√©f√®re imposer l'effort B
    
    ----------------------------------------
    R√©solution du second best (Al√©a Moral)
    ----------------------------------------
    
    Contrat optimal:
      wÃÑ (succ√®s) = 1764.00
      w (√©chec)  = 0.00
      √âcart wÃÑ - w = 1764.00
    
    R√©sultats:
      Profit esp√©r√© Principal: -784.80
      Utilit√© Agent (si e=H): 24.40
      Utilit√© Agent (si e=B): 24.40
    
    V√©rification des contraintes:
      CP (‚â• 0): 14.4000 ‚úì
      CI (‚â• 0): -0.0000  contrainte satur√©e
    
    Interpr√©tation:
      L'agent est incit√© √† fournir l'effort √©lev√© H
      Mais il supporte du risque (wÃÑ ‚â† w)
       œÄ_B = 0.63: Co√ªt d'agence = 1009.80
    


    
![png](output_22_1.png)
    

